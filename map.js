var obj= {
  "type": "FeatureCollection",
  "features": [
  {"type": "Feature", "geometry": {"type": "Point", "coordinates": [115.7721181, -31.7430766]}, "properties": {"name": "A N M BAZLUR RASHID", "dept": "CSE", "series": "2000", "optional": "Currently studying PhD", "address": "Joondalup, WA, Australia"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-86.1141996, 41.7522743]}, "properties": {"name": "Shamsul Alam", "dept": "EEE", "series": "1993", "optional": "Wireless System Engineer, Verizon ", "address": "Granger, IN, United States"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [101.6063143, 2.9231958]}, "properties": {"name": "Md Morad Hossain Munshi   ", "dept": "EEE", "series": "1996", "optional": "IT consultant ", "address": "Putrajaya, Selangor, Malaysia"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [46.7150648, 24.6319692]}, "properties": {"name": "Faruk Chowdhury", "dept": "CSE", "series": "2000", "optional": "Senior Software Engineer at MEDGULF(www.medgulf.com.sa)", "address": "Riyadh, ar-Riyad, Saudi Arabia"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [51.5213961066184, 25.3147091]}, "properties": {"name": "Asraf Siddiquee", "dept": "CE", "series": "1995", "optional": "Technical Manager at International Technical Laboratory.", "address": "Doha, Qatar, Qatar"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [101.692657987065, 3.1532433]}, "properties": {"name": "M Obaydullah ", "dept": "CE", "series": "1995", "optional": "Senior Structural Engineer, Jacobs Malaysia ", "address": "Kuala Lumpur , Kuala Lumpur , Malaysia"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-71.0582912, 42.3602534]}, "properties": {"name": "Abdullah Al Bashit", "dept": "EEE", "series": "2006", "optional": "", "address": "Boston, MA, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-84.3901849, 33.7490987]}, "properties": {"name": "Abdullah Muqim ", "dept": "CSE", "series": "1998", "optional": "Lead developer at Coke One NA", "address": "Atlanta , GA, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-87.09579990796851, 33.681287292031485]}, "properties": {"name": "Ahmed Eisty ", "dept": "", "series": "", "optional": "", "address": "Tuscaloosa, AL, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-82.3249961, 29.6519396]}, "properties": {"name": "Ahmed Raaz", "dept": "EEE", "series": "2005", "optional": "", "address": "Gainesville , FL, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-79.9667803850432, 26.47500651495681]}, "properties": {"name": "Alamgir Kabir Munna ", "dept": "EEE", "series": "2008", "optional": "", "address": "Boca Raton, FL, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-110.47192643938278, 32.67620056061722]}, "properties": {"name": "Dr. Md Iqbal Hossain", "dept": "CSE", "series": "2000", "optional": "Works at The University of Arizona", "address": "Tucson, AZ, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-122.0285259, 36.9749416]}, "properties": {"name": "Fahim Hasan Khan ", "dept": "", "series": "", "optional": "", "address": "Santa Cruz, CA, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-97.9405828, 29.8826436]}, "properties": {"name": "Fatema Tuj Zohora", "dept": "", "series": "", "optional": "", "address": "San Marcos, TX, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-83.0466403, 42.3315509]}, "properties": {"name": "Jaydeb Sarker ", "dept": "", "series": "", "optional": "", "address": "Detroit, MI, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-86.8024326, 33.5206824]}, "properties": {"name": "Kamal Hossain ", "dept": "EEE", "series": "2005", "optional": "", "address": "Birmingham, AL, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-89.216655, 37.7274692]}, "properties": {"name": "Kamruzzaman Shuvo ", "dept": "", "series": "", "optional": "", "address": "Carbondale, IL, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-81.0343313, 34.0007493]}, "properties": {"name": "Kazi Moinul Islam ", "dept": "", "series": "", "optional": "", "address": "Columbia, SC, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-90.0701156, 29.9499323]}, "properties": {"name": "Khairul Habib Pulok ", "dept": "", "series": "", "optional": "", "address": "New Orleans, LA, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-96.929101, 42.7795273]}, "properties": {"name": "M Rasel Mahmud ", "dept": "CSE", "series": "2009", "optional": "", "address": "Vermillion, SD, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-115.92719203440596, 43.890202965594035]}, "properties": {"name": "Mahfuza Khatun Muni", "dept": "EEE", "series": "2006", "optional": "", "address": "Boise, ID, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-81.7832912, 32.4490141]}, "properties": {"name": "Makhluk Prio ", "dept": "EEE", "series": "2009", "optional": "", "address": "Statesboro, GA, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-111.8348631, 41.7313447]}, "properties": {"name": "Md Ferdous Pervej", "dept": "EEE", "series": "2009", "optional": "I will move to Raleigh, NC this August", "address": "Logan , UT, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-73.140943, 40.9256538]}, "properties": {"name": "Md Imran Hossain", "dept": "", "series": "", "optional": "", "address": "Stony Brook, NY, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-89.93471430055781, 35.265935699442196]}, "properties": {"name": "Md Kamal Hossain ", "dept": "", "series": "", "optional": "", "address": "Memphis, TN, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-87.30639802103312, 42.19358477896688]}, "properties": {"name": "Md Shahidullah", "dept": "ETE", "series": "2005", "optional": "Software Developer @ PLS Financial Services", "address": "Chicago,  IL, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-93.6170554, 42.0267703]}, "properties": {"name": "Md.Maruf Ahamed Beddut ", "dept": "ETE", "series": "2005", "optional": "", "address": "Ames, IA, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-87.16273685065265, 42.33724594934735]}, "properties": {"name": "Mohammed Toufikul Islam", "dept": "ETE", "series": "2007", "optional": "", "address": "Chicago, IL, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-83.4129254, 30.4693772]}, "properties": {"name": "Mohammed Ziaur Rahaman ", "dept": "CE", "series": "2007", "optional": "", "address": "Madison, WI, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-94.5781416, 39.100105]}, "properties": {"name": "Mustafa Shovon", "dept": "", "series": "", "optional": "", "address": "Kansas City, MO, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-121.7445835, 38.545379]}, "properties": {"name": "Nayan Paul", "dept": "EEE", "series": "2007", "optional": "", "address": "Davis, CA, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-115.70412296399701, 44.11327203600299]}, "properties": {"name": "Nuhil Mehdy", "dept": "CSE", "series": "2005", "optional": "", "address": "Boise, ID, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-83.1763145, 42.3222599]}, "properties": {"name": "Refat Rafi ", "dept": "", "series": "", "optional": "", "address": "Dearborn, MI, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-87.2477421904589, 33.52934500954111]}, "properties": {"name": "Roni Paul", "dept": "", "series": "", "optional": "", "address": "Tuscaloosa, AL, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-79.58955402878428, 26.852232871215723]}, "properties": {"name": "Ronojoy Barua ", "dept": "ME", "series": "2006", "optional": "", "address": "Boca Raton, FL, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-89.62655054511976, 35.574099454880255]}, "properties": {"name": "Sabbir Bin Zaman ", "dept": "EEE", "series": "2006", "optional": "", "address": "Memphis, TN, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-110.67031548762388, 32.47781151237613]}, "properties": {"name": "Sammi Abida Salma", "dept": "CSE", "series": "2000", "optional": "", "address": "Tucson, AZ, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-98.1624501, 26.3013982]}, "properties": {"name": "Shadin Shofe ", "dept": "", "series": "", "optional": "", "address": "Edinburg, TX, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-89.7982768869989, 35.4023731130011]}, "properties": {"name": "Sharif Mehedi Tanmay", "dept": "CSE", "series": "2006", "optional": "", "address": "Memphis, TN, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-115.8697665623386, 43.9476284376614]}, "properties": {"name": "Sohel Rana", "dept": "EEE", "series": "2009", "optional": "", "address": "Boise, ID, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-90.7034522, 35.8428646]}, "properties": {"name": "Tamal Sarkar ", "dept": "EEE", "series": "2008", "optional": "", "address": "Jonesboro, AR, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-89.58351579589163, 35.61713420410838]}, "properties": {"name": "Tamanna Shamrin", "dept": "CSE", "series": "2007", "optional": "", "address": "Memphis, TN, USA"}}, 
 {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-79.7553452, 33.8709959]}, "properties": {"name": "Utpal Saha Salt ", "dept": "", "series": "", "optional": "", "address": "Lake City, UT, USA"}}
]};var layer;
var orginalcopy;
var tmplayer;
var searchcount = 0
var found=0;
function search(txt) {
txt=  txt.trim()
//if (txt.length==0) { loaddata(); return 0;}

found=0;
  layer.setStyle(function(feature) {
    var f = feature["l"]
    if (isfound(f, txt)){
      //return null;
        return /** @type {google.maps.Data.StyleOptions} */ (ruetselectstyle);
     }
    else
      return /** @type {google.maps.Data.StyleOptions} */ (ruetstyle);
  });


  //console.log(found);



}



function isfound(f, txt) {
if (txt.length==0) return 0;

  var string = f.name + " " + f.address + " " + f.dept + " " + f.optional + " " + f.series
  string = string.toLowerCase()
  if (string.indexOf(txt.toLowerCase()) > -1) {

    found=found+1; return 1;
  }
  return 0;
}

function CenterControl(controlDiv, map) {
  // Set CSS for the control border.
  var controlUI = document.createElement('div');
  controlUI.style.backgroundColor = '#fff';
  controlUI.style.border = '2px solid #fff';
  controlUI.style.borderRadius = '3px';
  controlUI.style.boxShadow = '0 2px 6px rgba(0,0,0,.3)';
  controlUI.style.cursor = 'pointer';
  controlUI.style.marginBottom = '22px';
  controlUI.style.textAlign = 'center';
  controlUI.title = 'RUETian Map';
  controlDiv.appendChild(controlUI);

  // Set CSS for the control interior.
  var controlText = document.createElement('div');
  controlText.style.color = 'rgb(25,25,25)';
  controlText.style.fontFamily = 'Roboto,Arial,sans-serif';
  controlText.style.fontSize = '16px';
  controlText.style.lineHeight = '38px';
  controlText.style.paddingLeft = '5px';
  controlText.style.paddingRight = '5px';
  controlText.innerHTML = '<input onchange="search(this.value)" type=text placeholder="name/series/dept"> <br> <a target="_blank" href="https://forms.gle/crHkXGGBGJpeYZf76">How can I add my information?</a>';
  controlUI.appendChild(controlText);

  // Setup the click event listeners: simply set the map to Chicago.
  controlUI.addEventListener('click', function() {
    //   map.setCenter(chicago);
  });

}


var ruetstyle;
var ruetstyle2;
var map;
var ruetselectstyle;
function initMap() {



  var image = {
           url: 'marker.png',
         };



    ruetstyle = {
      icon: {
        path: google.maps.SymbolPath.CIRCLE,
        scale: 10,
        fillColor: '#f00',
        fillOpacity: 0.45,
        strokeWeight: 0
      }
    };




  //  ruetstyle={icon:{url:'http://maps.google.com/mapfiles/ms/icons/blue-dot.png'}}
    ruetselectstyle=null;


  map = new google.maps.Map(document.getElementById('map'), {
    zoom: 5,
    center: {
      lat: 39,
      lng: -91
    },
    mapTypeId: 'roadmap',
    mapTypeControlOptions: {
      mapTypeIds: ['roadmap']
    }  });

  loaddata()
  var centerControlDiv = document.createElement('div');
  var centerControl = new CenterControl(centerControlDiv, map);
  centerControlDiv.index = 1;
  map.controls[google.maps.ControlPosition.TOP_CENTER].push(centerControlDiv);

}

function loaddata() {
  layer = new google.maps.Data();
  layer.addGeoJson(obj)
  layer.setStyle(function(feature) {
    return /** @type {google.maps.Data.StyleOptions} */ (ruetstyle);
  });
  layer.addListener('click', markerclick);
  layer.setMap(map);

}

function markerclick(event) {
  var infowindow = new google.maps.InfoWindow();


  var feat = event.feature;
  var html = "<b>" + feat.getProperty('name') + "</b><br>" + feat.getProperty('dept') + ", " + feat.getProperty('series') + "<br>" + feat.getProperty('optional') + "<br>" + feat.getProperty('address');
  infowindow.setContent(html);
  infowindow.setPosition(event.latLng);
  // infowindow.setOptions({pixelOffset: new google.maps.Size(0,-34)});
  infowindow.open(map);


}
